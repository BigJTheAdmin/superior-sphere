---
// Career Services ‚Äî Stripe-ready with smart fallback
import PageLayout from "@/layouts/Base.astro";

/* =====================================================
   Stripe links (TEST & LIVE) + smart fallback
   - Paste TEST links in STRIPE_TEST (https://buy.stripe.com/test_...)
   - Paste LIVE links in STRIPE_LIVE (https://buy.stripe.com/live_...)
   - Switch modes with .env: PUBLIC_STRIPE_MODE=test|live
   - If a link is missing in the selected mode, we fall back to the other mode.
   - If neither mode has a real Stripe URL, buttons fall back to #intake and preselect the package.
===================================================== */
const STRIPE_MODE = (import.meta.env.PUBLIC_STRIPE_MODE ?? "test").toLowerCase();

type StripeLinks = {
  resumeReview: string;     // R√©sum√© Review
  resumeLinkedIn: string;   // R√©sum√© + LinkedIn
  careerBranding: string;   // Career Branding Package
};

const STRIPE_TEST: StripeLinks = {
  // ‚¨áÔ∏è Paste your TEST links
  resumeReview:   "PASTE_TEST_resume_review",
  resumeLinkedIn: "PASTE_TEST_resume_linkedin",
  careerBranding: "PASTE_TEST_career_branding",
};

const STRIPE_LIVE: StripeLinks = {
  // ‚¨áÔ∏è Your LIVE links (already provided)
  resumeReview:   "https://buy.stripe.com/6oU3cwcjifz10GuenD9k407",
  resumeLinkedIn: "https://buy.stripe.com/7sY00kfvu86zgFs3IZ9k406",
  careerBranding: "https://buy.stripe.com/7sY6oIcjifz1ah47Zf9k405",
};

const STRIPE_HOST_RE = /^https?:\/\/buy\.stripe\.com\//i;
const FALLBACK = "#intake";

function isStripeUrl(u: string) { return STRIPE_HOST_RE.test(u || ""); }

// Prefer selected mode; if missing, fall back to the other mode‚Äôs value.
function resolveStripeLinks(): StripeLinks {
  const primary = STRIPE_MODE === "live" ? STRIPE_LIVE : STRIPE_TEST;
  const secondary = STRIPE_MODE === "live" ? STRIPE_TEST : STRIPE_LIVE;
  const pick = (k: keyof StripeLinks) => isStripeUrl(primary[k]) ? primary[k] : (isStripeUrl(secondary[k]) ? secondary[k] : "");
  return {
    resumeReview:   pick("resumeReview"),
    resumeLinkedIn: pick("resumeLinkedIn"),
    careerBranding: pick("careerBranding"),
  };
}

const STRIPE = resolveStripeLinks();

// If you configure Stripe "after completion" redirect back here like:
// /career/career-services?pkg=review&paid=1 ‚Äî we‚Äôll preselect and show a confirmation note.
const url = new URL(Astro.request.url);
const pkgParam = (url.searchParams.get("pkg") || "").toLowerCase(); // review | resume_linkedin | career_branding
const paid = url.searchParams.get("paid") === "1";

// Dev warning for missing links
if (import.meta.env.DEV) {
  Object.entries(STRIPE).forEach(([k, v]) => {
    if (!isStripeUrl(v)) console.warn(`Stripe Payment Link missing for ${k} (mode=${STRIPE_MODE}). Using form fallback.`);
  });
}
---

<PageLayout meta={{ title: "LinkedIn & R√©sum√© Services ‚Äî PingTraceSSH" }}>
  <section class="tool-wrapper toolkits-page">
    <header class="hero">
      <h1>LinkedIn & R√©sum√© Services</h1>
      <p class="tagline">
        Stop getting ignored. We turn your r√©sum√© and LinkedIn into recruiter magnets ‚Äî
        ATS-optimized, results-driven, and tailored for IT & network pros.
      </p>
      <div class="cta-row">
        <a class="btn primary" href="#packages">See Packages</a>
        <a class="btn" href="#intake">Start Your Review</a>
      </div>
    </header>

    <!-- Tier Cards -->
    <div class="tiers" id="packages">
      <!-- Review -->
      <article class="card free">
        <div class="ribbon soon">Available Now</div>
        <h2>R√©sum√© Review <span class="pill">$79</span></h2>
        <p class="blurb">
          Quick, actionable feedback that gets you unstuck ‚Äî perfect if you already have a decent
          draft and want expert eyes.
        </p>
        <ul class="features">
          <li>Tracked-changes markup + clean final export</li>
          <li>ATS keyword analysis for your target roles</li>
          <li>Structure, impact bullet rewrites, and clarity fixes</li>
          <li>2‚Äì3 business day turnaround</li>
          <li>1 free revision within 30 days</li>
        </ul>
        <div class="price-row">
          <div class="price">$79</div>
          <a
            class="btn primary js-stripe"
            href={STRIPE.resumeReview}
            data-fallback={FALLBACK}
            data-pkg="review"
          >Start Review</a>
        </div>
      </article>

      <!-- Review + LinkedIn -->
      <article class="card pro">
        <div class="ribbon soon">Best Value</div>
        <h2>R√©sum√© + LinkedIn <span class="pill">$149</span></h2>
        <p class="blurb">
          Our most popular upgrade ‚Äî polish your r√©sum√© and align your LinkedIn so recruiters find
          (and message) you first.
        </p>
        <ul class="features">
          <li>Complete r√©sum√© edit + modern, clean formatting</li>
          <li>LinkedIn headline, About, skills & keyword overhaul</li>
          <li>Role-targeted ATS optimization & job-match tuning</li>
          <li>48‚Äì72 hour turnaround</li>
          <li>1 free revision within 30 days</li>
        </ul>
        <div class="price-row">
          <div class="price">$149</div>
          <a
            class="btn js-stripe"
            href={STRIPE.resumeLinkedIn}
            data-fallback={FALLBACK}
            data-pkg="resume_linkedin"
          >Optimize Both</a>
        </div>
      </article>

      <!-- Career Branding -->
      <article class="card ultimate">
        <div class="ribbon soon">Premium</div>
        <h2>Career Branding Package <span class="pill">$299</span></h2>
        <p class="blurb">
          Full transformation for serious job seekers and career changers ‚Äî get positioning,
          message, and strategy handled.
        </p>
        <ul class="features">
          <li>Full r√©sum√© rewrite + premium template options</li>
          <li>LinkedIn overhaul with recruiter-tested copy</li>
          <li>30-minute strategy call (interview angle & story)</li>
          <li>Priority 24‚Äì48 hour turnaround</li>
          <li>Custom ‚ÄúCareer Growth Roadmap‚Äù PDF</li>
        </ul>
        <div class="price-row">
          <div class="price">$299</div>
          <a
            class="btn js-stripe"
            href={STRIPE.careerBranding}
            data-fallback={FALLBACK}
            data-pkg="career_branding"
          >Get the Premium Upgrade</a>
        </div>
      </article>
    </div>

    <!-- Comparison Table -->
    <div class="compare">
      <h3>Compare Services</h3>
      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>Capability</th>
              <th>R√©sum√© Review</th>
              <th>R√©sum√© + LinkedIn</th>
              <th>Career Branding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Tracked-changes edit + clean final file</td>
              <td>Included</td>
              <td>Included</td>
              <td>Included</td>
            </tr>
            <tr>
              <td>ATS keyword analysis & job-match tuning</td>
              <td>Included</td>
              <td>Included (enhanced)</td>
              <td>Included (enhanced)</td>
            </tr>
            <tr>
              <td>LinkedIn headline, About & skills overhaul</td>
              <td>‚Äî</td>
              <td>Included</td>
              <td>Included</td>
            </tr>
            <tr>
              <td>Turnaround time</td>
              <td>2‚Äì3 business days</td>
              <td>48‚Äì72 hours</td>
              <td>24‚Äì48 hours (priority)</td>
            </tr>
            <tr>
              <td>Live strategy call</td>
              <td>‚Äî</td>
              <td>‚Äî</td>
              <td>30 minutes</td>
            </tr>
            <tr>
              <td>Career Growth Roadmap PDF</td>
              <td>‚Äî</td>
              <td>‚Äî</td>
              <td>Included</td>
            </tr>
            <tr>
              <td>Revisions</td>
              <td>1 revision / 30 days</td>
              <td>1 revision / 30 days</td>
              <td>1 revision / 30 days</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Value Prop -->
    <section class="value">
      <h3>What makes this a 5-star experience?</h3>
      <ul class="value-points">
        <li>
          <strong>Recruiter-first writing.</strong> Impact bullets and clean structure that pass the
          7-second skim test.
        </li>
        <li>
          <strong>ATS-ready by default.</strong> Your r√©sum√© won‚Äôt disappear in filters ‚Äî we align to
          real job posts.
        </li>
        <li>
          <strong>Before/after transformation.</strong> You‚Äôll see exactly how we improved clarity, numbers,
          and story.
        </li>
        <li>
          <strong>Fast and frictionless.</strong> Simple intake, quick turnaround, and revision support
          included.
        </li>
        <li>
          <strong>Built for IT & networking.</strong> We speak your stack ‚Äî firewalls, routing, cloud,
          automation, and impact.
        </li>
      </ul>
    </section>

    <!-- Intake Form -->
    <section class="waitlist" id="intake">
      <h3>Start Your Review</h3>
      {paid && (
        <p class="fineprint" role="status">
          Payment received ‚Äî complete the intake and we‚Äôll begin right away.
        </p>
      )}
      <p>Tell us where you‚Äôre headed. We‚Äôll handle the words, positioning, and polish.</p>

      <form
        id="intakeForm"
        name="career-services-intake"
        action="https://formspree.io/f/xovlgveo"
        method="POST"
        accept-charset="UTF-8"
        class="waitlist-form"
      >
        <input type="hidden" name="_subject" value="New Career Services Intake ‚Äî PingTraceSSH" />
        <input type="hidden" name="_redirect" value="/thank-you" />
        <input type="text" name="_honeypot" class="hidden" tabindex="-1" autocomplete="off" />

        <div class="grid">
          <label>
            Name
            <input type="text" name="name" placeholder="J. Admin" required />
          </label>
          <label>
            Email
            <input type="email" name="email" placeholder="you@company.com" required />
          </label>
        </div>

        <div class="grid">
          <label>
            Current Role
            <input
              type="text"
              name="current_role"
              placeholder="Network Engineer, NOC Analyst, etc."
            />
          </label>
          <label>
            Target Role
            <input
              type="text"
              name="target_role"
              placeholder="Senior Network Engineer, Cloud Security, etc."
            />
          </label>
        </div>

        <div class="grid">
          <label>
            LinkedIn URL
            <input type="url" name="linkedin" placeholder="https://www.linkedin.com/in/you" />
          </label>
          <label>
            Package
            <select name="package" required>
              <!-- üîÅ Prices aligned with the cards above -->
              <option value="Resume Review" selected={pkgParam==="review"}>$79 ‚Äî R√©sum√© Review</option>
              <option value="Resume + LinkedIn" selected={pkgParam==="resume_linkedin"}>$149 ‚Äî R√©sum√© + LinkedIn</option>
              <option value="Career Branding" selected={pkgParam==="career_branding"}>$299 ‚Äî Career Branding</option>
            </select>
          </label>
        </div>

        <label>
          Notes / target job links (optional)
          <textarea
            name="notes"
            rows="4"
            placeholder="Paste 1‚Äì3 target job links or add context we should know."></textarea>
        </label>

        <button id="submitBtn" type="submit" class="btn primary">Submit &amp; Get Started</button>

        <p
          id="formStatus"
          class="fineprint"
          role="status"
          aria-live="polite"
          style="min-height:1.25rem;"
        ></p>
      </form>

      <p class="fineprint">
        You‚Äôll receive a confirmation with next steps and a secure upload link for your r√©sum√©.
      </p>
    </section>

    <!-- FAQ -->
    <section class="faq">
      <h3>Frequently Asked</h3>
      <details>
        <summary>Will this work with Applicant Tracking Systems (ATS)?</summary>
        <p>
          Yes. We optimize headings, keywords, and formatting so your r√©sum√© parses cleanly and
          ranks for your target roles.
        </p>
      </details>
      <details>
        <summary>Do you use templates?</summary>
        <p>
          We start with recruiter-approved layouts, then tailor content and structure to your
          experience and target role.
        </p>
      </details>
      <details>
        <summary>What files do I get back?</summary>
        <p>
          Tracked-changes version (so you can see edits), a clean final PDF, and an editable DOCX.
          LinkedIn copy is delivered in a paste-ready doc.
        </p>
      </details>
      <details>
        <summary>Do you offer refunds?</summary>
        <p>
          We include one revision within 30 days. If we miss the mark on scope or timing, we‚Äôll make
          it right.
        </p>
      </details>
    </section>
  </section>
</PageLayout>

<style>
  .toolkits-page {
    --bg-light: #ffffff;
    --text-light: #0f172a;
    --muted-light: #475569;
    --border-light: #e5e7eb;

    --bg-dark: #0b1220;
    --text-dark: #f8fafc;
    --muted-dark: #cbd5e1;
    --border-dark: #334155;

    --accent: #0ea5e9; /* sky-500 */
    --accent-dark: #0284c7; /* sky-600 */
    --pro: #48b814; /* teal-500 */
    --ultimate: #f59e0b; /* amber-500 */
  }

  .hero {
    text-align: center;
    margin-bottom: 1.5rem;
  }
  .hero h1 {
    margin-bottom: 0.25rem;
  }
  .tagline {
    color: var(--muted-light);
    margin: 0 auto 1rem;
    max-width: 56rem;
  }
  .cta-row {
    display: flex;
    gap: 0.75rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn {
    display: inline-block;
    padding: 0.7rem 1.1rem;
    border-radius: 10px;
    background: #e5e7eb;
    color: #111827;
    border: 1px solid var(--border-light);
    text-decoration: none;
    font-weight: 600;
  }
  .btn.primary {
    background: var(--accent);
    color: #fff;
    border-color: transparent;
  }
  .btn.primary:hover {
    background: var(--accent-dark);
  }
  .btn:hover {
    filter: brightness(0.98);
  }

  .tiers {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
  @media (max-width: 980px) {
    .tiers {
      grid-template-columns: 1fr;
    }
  }

  .card {
    position: relative;
    border: 1px solid var(--border-light);
    border-radius: 14px;
    padding: 1.25rem;
    background: var(--bg-light);
    color: var(--text-light);
  }
  .card h2 {
    margin: 0 0 0.35rem 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
  }
  .pill {
    font-size: 0.9rem;
    font-weight: 700;
    padding: 0.15rem 0.5rem;
    border-radius: 999px;
    background: #e5e7eb;
    color: #111827;
  }
  .blurb {
    color: var(--muted-light);
    margin-bottom: 0.5rem;
  }
  .features {
    margin: 0.25rem 0 0.75rem;
    padding-left: 1.1rem;
  }
  .features li {
    margin: 0.2rem 0;
  }
  .price-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
  }
  .price {
    font-size: 1.3rem;
    font-weight: 800;
  }

  .card.pro { border-left: 4px solid var(--pro); }
  .card.ultimate { border-left: 4px solid var(--ultimate); }
  .card.free { border-left: 4px solid var(--accent); }

  .ribbon {
    position: absolute;
    top: 12px;
    right: 12px;
    background: #111827;
    color: #fff;
    font-size: 0.75rem;
    font-weight: 700;
    padding: 0.25rem 0.5rem;
    border-radius: 6px;
  }
  .ribbon.soon { background: #111827; }

  .compare { margin-top: 1rem; }
  .compare h3 { margin-bottom: 0.5rem; }
  .table-wrap {
    overflow-x: auto;
    border-radius: 12px;
    border: 1px solid var(--border-light);
  }
  .table { width: 100%; border-collapse: collapse; }
  .table th, .table td {
    padding: 0.75rem;
    border-bottom: 1px solid var(--border-light);
    text-align: left;
  }
  .table thead th { background: #f8fafc; }

  .value { margin: 1.5rem 0; }
  .value-points { padding-left: 1.1rem; }
  .value-points li { margin: 0.35rem 0; }

  .waitlist { margin-top: 1.25rem; }
  .waitlist h3 { margin-bottom: 0.25rem; }
  .waitlist-form label { display: block; margin: 0.5rem 0; font-weight: 500; }
  .waitlist-form .grid {
    display: grid;
    gap: 0.75rem 1rem;
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
  @media (max-width: 720px) { .waitlist-form .grid { grid-template-columns: 1fr; } }
  .waitlist-form input, .waitlist-form select, .waitlist-form textarea {
    width: 100%;
    padding: 0.6rem 0.7rem;
    border-radius: 10px;
    border: 1px solid var(--border-light);
    background: #fff;
    color: #0f172a;
  }
  .fineprint { margin-top: 0.5rem; color: var(--muted-light); font-size: 0.9rem; }
  .hidden { display: none !important; }

  .faq { margin-top: 1.25rem; }
  .faq details {
    border: 1px solid var(--border-light);
    border-radius: 10px;
    padding: 0.75rem 1rem;
    margin: 0.5rem 0;
  }
  .faq summary { font-weight: 700; cursor: pointer; }

  /* Dark mode */
  @media (prefers-color-scheme: dark) {
    .tagline, .fineprint { color: var(--muted-dark); }
    .btn { background: #1f2937; color: #f8fafc; border-color: var(--border-dark); }
    .btn:hover { filter: brightness(1.1); }
    .card { background: var(--bg-dark); color: var(--text-dark); border-color: var(--border-dark); }
    .pill { background: #334155; color: #f8fafc; }
    .blurb { color: var(--muted-dark); }
    .table-wrap { border-color: var(--border-dark); }
    .table th, .table td { border-bottom-color: var(--border-dark); }
    .table thead th { background: #0f172a; }
    .waitlist-form input, .waitlist-form select, .waitlist-form textarea {
      background: #0b1220; color: var(--text-dark); border-color: var(--border-dark);
    }
    .faq details { border-color: var(--border-dark); }
  }
</style>

<script is:inline>
  // Stripe fallback: if a .js-stripe button isn't a real Stripe link,
  // route to #intake and preselect the chosen package.
  (function () {
    const STRIPE_HOST = /^https?:\/\/buy\.stripe\.com\//i;
    const map = {
      "review": "Resume Review",
      "resume_linkedin": "Resume + LinkedIn",
      "career_branding": "Career Branding",
    };

    document.querySelectorAll(".js-stripe").forEach((btn) => {
      const href = btn.getAttribute("href") || "";
      if (!STRIPE_HOST.test(href)) {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          const pkg = btn.getAttribute("data-pkg") || "";
          const sel = document.querySelector('select[name="package"]');
          if (sel && map[pkg]) sel.value = map[pkg];
          location.hash = "#intake";
        });
      }
    });
  })();
</script>
