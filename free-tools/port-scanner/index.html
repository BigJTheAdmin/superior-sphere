<!DOCTYPE html><html class="scroll-smooth" lang="en-US" data-astro-cid-5hce7sga> <head><!-- Keep charset FIRST to prevent mojibake like Ã¢â‚¬â„¢ --><meta charset="utf-8"><!-- Mobile default at ~75% scale (no pinch-zoom needed) --><meta name="viewport" content="width=device-width, initial-scale=0.75, viewport-fit=cover"><!-- Helpful mobile/browser theming --><meta name="theme-color" content="#0b0f14"><meta name="color-scheme" content="dark light"><meta name="format-detection" content="telephone=no"><!-- Your existing head (title, SEO, OG tags, etc.) --><!-- BaseHead --><title>Port Scanner (Guided)</title><meta name="description" content="Networking tools, automation, and troubleshooting for IT professionals."><link rel="canonical" href="https://pingtracessh.com/free-tools/port-scanner/"><!-- Favicons (match files in /public) --><link rel="icon" href="/icon.png?v=2" sizes="any"><link rel="icon" href="/PTSicon.png?v=2" type="image/png"><link rel="apple-touch-icon" href="/icon.png?v=2"><meta name="theme-color" content="#0f0f0f"><!-- Open Graph --><meta property="og:type" content="website"><meta property="og:title" content="Port Scanner (Guided)"><meta property="og:description" content="Networking tools, automation, and troubleshooting for IT professionals."><meta property="og:url" content="https://pingtracessh.com/free-tools/port-scanner/"><meta property="og:site_name" content="Ping.Trace.SSH"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://pingtracessh.com/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Port Scanner (Guided)"><meta name="twitter:description" content="Networking tools, automation, and troubleshooting for IT professionals."><meta name="twitter:image" content="https://pingtracessh.com/"><!-- Optional: sitemap/rss if you actually generate them --><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Blog" href="/rss.xml"><!-- Mobile-safe baseline that wonâ€™t fight Tailwind --><link rel="stylesheet" href="/_astro/_slug_.BJY2hdSo.css">
<style>.wrap[data-astro-cid-lp553tkn]{max-width:1080px;margin:0 auto}header[data-astro-cid-lp553tkn] h1[data-astro-cid-lp553tkn]{margin:.2rem 0 .3rem}.sub[data-astro-cid-lp553tkn]{opacity:.9}.muted[data-astro-cid-lp553tkn]{opacity:.85}.card[data-astro-cid-lp553tkn]{border:1px solid var(--t-border, #30343b);border-radius:12px;background:var(--t-bg, #0f1115);padding:14px;margin:12px 0}.grid[data-astro-cid-lp553tkn]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}label[data-astro-cid-lp553tkn]{display:flex;flex-direction:column;gap:.3rem;font-weight:600}input[data-astro-cid-lp553tkn]{padding:.7rem .8rem;border-radius:10px;border:1px solid var(--t-border, #30343b);background:#0b0d11;color:#e8eaed}.row[data-astro-cid-lp553tkn]{display:flex;flex-wrap:wrap;gap:.6rem;align-items:center;margin-top:.6rem}.chips[data-astro-cid-lp553tkn]{display:flex;gap:.4rem;flex-wrap:wrap}.chip[data-astro-cid-lp553tkn]{padding:.4rem .6rem;border-radius:999px;border:1px solid #2f2f35;background:#161922;color:#ddd;cursor:pointer}.chip[data-astro-cid-lp553tkn]:hover{filter:brightness(1.15)}.toggles[data-astro-cid-lp553tkn] .check[data-astro-cid-lp553tkn]{margin-right:10px}.check[data-astro-cid-lp553tkn]{display:inline-flex;align-items:center;gap:.45rem;font-weight:500}.check[data-astro-cid-lp553tkn].small{font-size:.95rem;font-weight:500}.hint[data-astro-cid-lp553tkn]{opacity:.75;font-weight:400}.adv[data-astro-cid-lp553tkn] summary[data-astro-cid-lp553tkn]{cursor:pointer}.bullets[data-astro-cid-lp553tkn]{margin:.4rem 0 .1rem 1.2rem}.consent[data-astro-cid-lp553tkn]{background:#ffffff0a;border:1px dashed var(--t-border, #30343b);border-radius:10px;padding:.5rem .6rem}.actions[data-astro-cid-lp553tkn]{align-items:center}.btn[data-astro-cid-lp553tkn]{padding:.6rem .9rem;border-radius:10px;border:1px solid #2e3350;background:#171a24;color:#fff;cursor:pointer}.btn[data-astro-cid-lp553tkn].primary{background:var(--accent, #2d6dff);border-color:var(--accent, #2d6dff)}.btn[data-astro-cid-lp553tkn].ghost{background:transparent}.btn[data-astro-cid-lp553tkn][disabled]{opacity:.55;cursor:not-allowed}.spacer[data-astro-cid-lp553tkn]{flex:1 1 auto}.progress[data-astro-cid-lp553tkn]{position:relative;height:12px;background:#1a1f2b;border-radius:999px}.bar[data-astro-cid-lp553tkn]{position:absolute;left:0;top:0;bottom:0;width:0;background:var(--accent, #2d6dff);border-radius:999px;transition:width .15s linear}.progress[data-astro-cid-lp553tkn] #pct[data-astro-cid-lp553tkn]{position:absolute;right:8px;top:-22px;opacity:.8;font-size:.9rem}.error[data-astro-cid-lp553tkn]{background:#7f1d1d2e;border-color:#7f1d1d;color:#fca5a5}.table-wrap[data-astro-cid-lp553tkn]{overflow:auto}table[data-astro-cid-lp553tkn]{width:100%;border-collapse:collapse}thead[data-astro-cid-lp553tkn] th[data-astro-cid-lp553tkn]{text-align:left;border-bottom:1px solid var(--t-border, #30343b);padding:.5rem;cursor:pointer}tbody[data-astro-cid-lp553tkn] td[data-astro-cid-lp553tkn]{border-bottom:1px dashed rgba(255,255,255,.08);padding:.5rem;vertical-align:top}.open[data-astro-cid-lp553tkn]{color:#22c55e;font-weight:700}.closed[data-astro-cid-lp553tkn]{color:#ef4444;font-weight:700}.timeout[data-astro-cid-lp553tkn]{color:#f59e0b;font-weight:700}.tls-grid[data-astro-cid-lp553tkn]{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:.6rem}.tls-card[data-astro-cid-lp553tkn]{border:1px solid var(--t-border,#30343b);border-radius:10px;padding:.6rem;background:#0d0f14}.recent[data-astro-cid-lp553tkn]{display:flex;flex-wrap:wrap;gap:.4rem}.pill[data-astro-cid-lp553tkn]{border:1px solid #2f3344;background:#141824;color:#dcdde3;border-radius:999px;padding:.35rem .6rem;cursor:pointer}.pill[data-astro-cid-lp553tkn] small[data-astro-cid-lp553tkn]{opacity:.75}.pill[data-astro-cid-lp553tkn]:hover{filter:brightness(1.1)}
</style><script type="module" src="/_astro/page.V2R8AmkL.js"></script></head> <body class="bg-global-bg text-global-text flex min-h-screen flex-col px-4 pt-6 font-mono text-sm font-normal antialiased sm:px-8" data-astro-cid-5hce7sga> <script>
	const lightModePref = window.matchMedia("(prefers-color-scheme: light)");

	function getUserPref() {
		const storedTheme = typeof localStorage !== "undefined" && localStorage.getItem("theme");
		return storedTheme || (lightModePref.matches ? "light" : "dark");
	}

	function setTheme(newTheme) {
		if (newTheme !== "light" && newTheme !== "dark") {
			return console.warn(
				`Invalid theme value '${newTheme}' received. Expected 'light' or 'dark'.`,
			);
		}

		const root = document.documentElement;

		// root already set to newTheme, exit early
		if (newTheme === root.getAttribute("data-theme")) {
			return;
		}

		root.setAttribute("data-theme", newTheme);

		if (typeof localStorage !== "undefined") {
			localStorage.setItem("theme", newTheme);
		}
	}

	// initial setup
	setTheme(getUserPref());

	// View Transitions hook to restore theme
	document.addEventListener("astro:after-swap", () => setTheme(getUserPref()));

	// listen for theme-change custom event, fired in src/components/ThemeToggle.astro
	document.addEventListener("theme-change", (e) => {
		setTheme(e.detail.theme);
	});

	// listen for prefers-color-scheme change.
	lightModePref.addEventListener("change", (e) => setTheme(e.matches ? "light" : "dark"));
</script> <a class="sr-only focus:not-sr-only focus:fixed focus:start-1 focus:top-1.5" href="#main">skip to content
</a> <header class="group relative mb-8 flex w-full items-center sm:ps-18" id="main-header"> <!-- Left: Logo + Nav --> <div class="sm:flex-column flex flex-col items-center sm:items-center"> <a aria-current="false" class="inline-flex items-center sm:relative sm:inline-block" href="/"> <img src="/PTSwTerminalHORIZONTAL.png" alt="PingTraceSSH Logo" class="me-3 h-24 w-auto sm:h-45" loading="eager" decoding="async"> </a> <nav aria-label="Main menu" class="bg-global-bg/85 text-accent absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md py-4 shadow backdrop-blur-sm group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none" id="navigation-menu"> <a aria-current="false" class="px-4 py-4 underline-offset-2 hover:underline sm:py-0" data-astro-prefetch href="/"> Home </a><a aria-current="false" class="px-4 py-4 underline-offset-2 hover:underline sm:py-0" data-astro-prefetch href="/services/"> Services </a><a aria-current="false" class="px-4 py-4 underline-offset-2 hover:underline sm:py-0" data-astro-prefetch href="/career/"> Career Tools </a><a aria-current="false" class="px-4 py-4 underline-offset-2 hover:underline sm:py-0" data-astro-prefetch href="/free-tools/"> Networking Tools </a><a aria-current="false" class="px-4 py-4 underline-offset-2 hover:underline sm:py-0" data-astro-prefetch href="/breakroom/"> Breakroom </a><a aria-current="false" class="px-4 py-4 underline-offset-2 hover:underline sm:py-0" data-astro-prefetch href="/about/"> About </a> </nav> </div> <!-- Right: Search + Donate (pushed fully right) --> <div class="ms-auto flex items-center gap-4 shrink-0"> <a href="https://buy.stripe.com/fZu8wQ3MMaeH60O5R79k40f" class="inline-flex items-center" aria-label="Donate"> <img src="/donate2.png" alt="Donate" class="h-50 w-auto cursor-pointer transition-transform hover:scale-125" loading="lazy" decoding="async"> </a> <site-search class="ms-auto" id="search"> <button class="hover:text-accent flex h-9 w-9 cursor-pointer items-center justify-center rounded-md" aria-keyshortcuts="Control+K Meta+K" data-open-modal disabled> <!-- Magnifying glass --> <svg aria-hidden="true" class="h-7 w-7" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"> <path d="M0 0h24v24H0z" stroke="none"></path> <circle cx="11" cy="11" r="7"></circle> <path d="M21 21l-6-6"></path> </svg> <span class="sr-only">Open Search</span> </button> <dialog aria-label="search" class="bg-global-bg h-full max-h-full w-full max-w-full border border-zinc-400 shadow-sm backdrop:backdrop-blur-sm open:flex sm:mx-auto sm:mt-16 sm:mb-auto sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md"> <div class="dialog-frame flex grow flex-col gap-4 p-6 pt-12 sm:pt-6"> <button class="ms-auto cursor-pointer rounded-md bg-zinc-200 p-2 font-semibold dark:bg-zinc-700" data-close-modal>Close</button> <!-- SEARCH INPUT + RESULTS (replaces pagefind UI) --> <div class="flex flex-col gap-3"> <div class="relative"> <span class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 opacity-70"> <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"> <circle cx="11" cy="11" r="7"></circle> <line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </span> <input id="pts-search-input" type="search" placeholder="Search pagesâ€¦" class="w-full rounded-md border border-zinc-400 bg-transparent py-2 pl-9 pr-9 outline-none focus:border-accent" autocomplete="off" aria-controls="pts-search-results"> <button id="pts-search-clear" class="absolute right-2 top-1/2 -translate-y-1/2 rounded p-1 opacity-70 hover:opacity-100" title="Clear" aria-label="Clear" hidden> <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"> <line x1="18" y1="6" x2="6" y2="18"></line> <line x1="6" y1="6" x2="18" y2="18"></line> </svg> </button> </div> <div id="pts-search-results" role="listbox" class="max-h-[50vh] overflow-auto rounded-md border border-zinc-400"> <!-- results render here --> </div> </div> </div> </dialog> </site-search> <script type="module">class p extends HTMLElement{#n;#e;#r;#o;#t;#s=[];#l=!1;constructor(){super(),this.#o=this.querySelector("button[data-open-modal]"),this.#n=this.querySelector("button[data-close-modal]"),this.#e=this.querySelector("dialog"),this.#r=this.querySelector(".dialog-frame"),this.#t=new AbortController,this.#o?(this.#o.addEventListener("click",this.openModal),this.#o.disabled=!1):console.warn("Search button not found"),this.#n?this.#n.addEventListener("click",this.closeModal):console.warn("Close button not found"),this.#e?this.#e.addEventListener("close",()=>{window.removeEventListener("click",this.onWindowClick)}):console.warn("Dialog not found")}connectedCallback(){window.addEventListener("keydown",this.onWindowKeydown,{signal:this.#t.signal}),(window.requestIdleCallback||(t=>setTimeout(t,1)))(()=>this.#a())}disconnectedCallback(){this.#t.abort()}openModal=e=>{if(!this.#e)return;this.#e.showModal(),this.querySelector("#pts-search-input")?.focus(),e?.stopPropagation(),window.addEventListener("click",this.onWindowClick,{signal:this.#t.signal}),this.#i(this.#s.slice(0,10))};closeModal=()=>this.#e?.close();onWindowClick=e=>{("href"in(e.target||{})||document.body.contains(e.target)&&!this.#r?.contains(e.target))&&this.closeModal()};onWindowKeydown=e=>{this.#e&&(e.metaKey===!0||e.ctrlKey===!0)&&e.key==="k"&&(this.#e.open?this.closeModal():this.openModal(),e.preventDefault())};async#a(){if(!this.#l)try{const e=await fetch("/api/pages-search.json",{cache:"force-cache"});if(!e.ok)throw new Error("Failed to fetch page index");this.#s=await e.json()}catch(e){console.error(e),this.#s=[]}finally{this.#l=!0,this.#c()}}#c(){const e=this.querySelector("#pts-search-input"),t=this.querySelector("#pts-search-clear");if(!e)return;const i=()=>{const r=e.value.trim().toLowerCase();if(!r){this.#i(this.#s.slice(0,10)),t&&(t.hidden=!0);return}t&&(t.hidden=!1);const l=r.split(/\s+/).filter(Boolean),a=s=>{let o=0;const d=(s.title||"").toLowerCase(),h=(s.description||"").toLowerCase(),u=(s.keywords||[]).map(n=>(n||"").toLowerCase());for(const n of l)d.includes(n)&&(o+=3),u.some(f=>f.includes(n))&&(o+=2),h.includes(n)&&(o+=1);return o},c=this.#s.map(s=>({doc:s,s:a(s)})).filter(s=>s.s>0).sort((s,o)=>o.s-s.s).slice(0,50).map(s=>s.doc);this.#i(c)};e.addEventListener("input",i,{signal:this.#t.signal}),e.addEventListener("keydown",r=>{r.key==="Escape"&&(e.value="",t&&(t.hidden=!0),this.#i(this.#s.slice(0,10)))},{signal:this.#t.signal}),t?.addEventListener("click",()=>{e.value="",t.hidden=!0,this.#i(this.#s.slice(0,10)),e.focus()},{signal:this.#t.signal})}#i(e){const t=this.querySelector("#pts-search-results");if(t){if(!e.length){t.innerHTML='<div class="p-3 text-sm opacity-70">No matches. Try different keywords.</div>';return}t.innerHTML=e.map(i=>`
        <a href="${i.url}" role="option" class="block border-b border-zinc-700/40 p-3 hover:bg-accent/10 focus:bg-accent/10 focus:outline-none">
          <div class="font-semibold">${i.title}</div>
          ${i.description?`<div class="mt-0.5 text-sm opacity-80">${i.description}</div>`:""}
        </a>
      `).join("")}}}customElements.define("site-search",p);</script> </div> <!-- Mobile hamburger --> <mobile-button> <button aria-expanded="false" aria-haspopup="menu" class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden" id="toggle-navigation-menu" type="button"> <span class="sr-only">Open main menu</span> <svg aria-hidden="true" class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"> <path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"></path> </svg> <svg aria-hidden="true" class="text-accent absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"> <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path> </svg> </button> </mobile-button> </header> <script type="module">function s(t,e){t.classList.toggle(e)}class l extends HTMLElement{#e=!1;connectedCallback(){const e=document.getElementById("main-header"),n=this.querySelector("button");n?.addEventListener("click",()=>{e&&s(e,"menu-open"),this.#e=!this.#e,n.setAttribute("aria-expanded",this.#e.toString())})}}customElements.define("mobile-button",l);</script> <!-- Live status bar --> <div id="status-ticker-host"></div> <script type="module">
  const host = document.getElementById("status-ticker-host");
  const root = host.attachShadow({ mode: "open" });

  root.innerHTML = `
    <style>
      .ticker-wrapper{overflow:hidden;background:#111;border-bottom:2px solid #333}
      .ticker{display:inline-flex;white-space:nowrap;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:.85rem;padding:.5rem 1rem;gap:3rem;font-weight:700;will-change:transform}
      .lane{display:inline-flex;white-space:nowrap;gap:2rem}
      .chip{display:inline-flex;align-items:center;gap:.5rem;padding:.15rem .5rem;border-radius:9999px;border:1px solid #333;background:#0b0b0b}
      .dot{width:8px;height:8px;border-radius:9999px;box-shadow:0 0 8px currentColor}
      .up{color:#14f195!important}
      .down{color:#ff3b3b!important}
      .checking{color:#ffb020!important}
      .track{position:relative;width:100%;overflow:hidden}
      .rail{display:inline-flex;white-space:nowrap;gap:3rem;animation:scroll linear infinite}
      @keyframes scroll{from{transform:translateX(0)}to{transform:translateX(-50%)}}
      .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0;white-space:nowrap}
    </style>

    <div class="ticker-wrapper" aria-live="polite" aria-atomic="false">
      <div class="track">
        <div id="rail" class="rail">
          <div id="laneA" class="ticker lane">Loadingâ€¦</div>
          <div id="laneB" class="ticker lane">Loadingâ€¦</div>
        </div>
      </div>
      <span id="a11y" class="sr-only"></span>
    </div>
  `;

  const $ = (s)=>root.querySelector(s);
  const laneA = $("#laneA");
  const laneB = $("#laneB");
  const rail  = $("#rail");
  const a11y  = $("#a11y");

  /** CONFIG **/
  // IMPORTANT: On GitHub Pages, files in /public build to the site root.
  // We compute the correct absolute URL whether you're on a custom domain
  // or a subpath (e.g., https://username.github.io/repo/).
  const JSON_FILENAME = "ping-services.json";
  let FETCH_URL = "/ping-services.json";
  try {
    const baseHref = document.querySelector('base')?.getAttribute('href') || "/";
    // new URL(relative, base) handles both "/" and "/repo/" styles
    FETCH_URL = new URL(JSON_FILENAME, new URL(baseHref, location.origin)).toString();
  } catch { /* noop; fallback stays "/ping-services.json" */ }

  const BASE_POLL_MS = 30_000;
  const POLL_JITTER_MS = 5_000;
  const FETCH_TIMEOUT_MS = 12_000;           // backend sometimes slow
  const PX_PER_SEC = 90;
  const DATA_STALE_MS = 3 * 60_000;          // too old to trust
  const DATA_FRESH_MS = 75_000;              // fresh enough to infer UP if no fails
  const REQUIRE_CONSEC_FAILS = 2;            // confirm DOWN
  const LOCAL_CACHE_KEY = "pts_status_ticker_cache_v4";
  const STATE_CACHE_KEY = "pts_status_ticker_state_v4";

  const renderCache = loadJson(LOCAL_CACHE_KEY) || { items: [], ts: 0 };
  const stateCache  = loadJson(STATE_CACHE_KEY)  || {}; // { [name]: {state,lastTs} }

  // Instant paint from cache (prevents empty bar on first load)
  if (renderCache.items?.length) {
    render(renderCache.items); autosizeScroller();
  }

  // Poll with jitter
  let pollTimer=null;
  const tick = async()=>{ await update(); scheduleNext(); };
  scheduleNext(true);
  function scheduleNext(immediate=false){
    if(pollTimer) clearTimeout(pollTimer);
    if(immediate) return void tick();
    const j=(Math.random()*2-1)*POLL_JITTER_MS;
    pollTimer=setTimeout(tick, BASE_POLL_MS+j);
  }

  document.addEventListener("visibilitychange", ()=> {
    rail.style.animationPlayState = document.hidden ? "paused" : "running";
  });
  new ResizeObserver(()=>autosizeScroller()).observe(rail);

  /** fetch with timeout + one retry */
  async function fetchJson() {
    const once = async () => {
      const controller = new AbortController();
      const timer = setTimeout(()=>controller.abort(), FETCH_TIMEOUT_MS);
      try {
        const res = await fetch(FETCH_URL, { cache: "no-store", signal: controller.signal });
        if (!res.ok) throw new Error(`HTTP ${res.status} at ${FETCH_URL}`);
        return await res.json();
      } finally { clearTimeout(timer); }
    };
    try { return await once(); }
    catch(e){
      console.warn("[StatusTicker] fetch failed, retrying:", e?.message||e);
      try { return await once(); }
      catch(e2){
        console.warn("[StatusTicker] second fetch failed, using cache:", e2?.message||e2);
        // fall back to last known good data if we have it
        if (renderCache.items?.length) return renderCache.items;
        throw e2;
      }
    }
  }

  async function update(){
    let data;
    try { data = await fetchJson(); }
    catch { return; } // keep last good

    const arr = Array.isArray(data) ? data : (data?.results ?? data ?? []);
    if (!Array.isArray(arr) || !arr.length) return;

    const cooked = postProcess(arr);
    if (!cooked.length) return;

    render(cooked); autosizeScroller();
    saveJson(LOCAL_CACHE_KEY, { items: cooked, ts: Date.now() });

    const downs=cooked.filter(i=>i.state==="down");
    a11y.textContent = downs.length ? `${downs.length} services down: ${downs.map(d=>d.name).join(", ")}`
                                    : `All services up (${cooked.length})`;
  }

  function postProcess(raw){
    const now=Date.now();
    const list = raw.map(r=>normalizeOne(r,now)).filter(Boolean).filter(i=>!i.isStale).map(applyOptimistic);

    // persist last known
    for(const i of list){ stateCache[i.name]={state:i.state,lastTs:i.lastTs}; }
    saveJson(STATE_CACHE_KEY,stateCache);

    // down -> up -> checking
    const order={down:0,up:1,checking:2};
    list.sort((a,b)=> order[a.state]-order[b.state] || a.name.localeCompare(b.name));
    return list;
  }

  function normalizeOne(r, now){
    const name=String(r.name ?? r.service ?? r.id ?? "").trim();
    if(!name) return null;

    const lastTs = toMs(r.lastSeen) ?? toMs(r.lastUpdate) ?? toMs(r.checkedAt) ?? toMs(r.timestamp) ?? now;
    const age = now - lastTs;
    const isStale = age > DATA_STALE_MS;
    const isFresh = age <= DATA_FRESH_MS;

    const explicitUp   = asBool(r.up) || asBool(r.ok) || r.status===200 || String(r.status||"").startsWith("2");
    const explicitDown = asBool(r.down) || String(r.state||"").toLowerCase()==="down" ||
                         String(r.health||"").toLowerCase()==="unhealthy" || String(r.status||"").startsWith("5");

    const fails = Number(r.consecutiveFails ?? r.failures ?? r.consecutive_failures ?? 0) || 0;

    return {
      name, lastTs, isStale, isFresh, explicitUp, explicitDown, fails,
      latencyMs: numOrNull(r.latencyMs ?? r.rtt ?? r.latency),
      region: r.region ?? r.pop ?? null,
      state: explicitUp ? "up" : (explicitDown ? "down" : "checking"),
    };
  }

  // **Key inference**
  // - Explicit UP => UP
  // - Explicit DOWN (fresh) => DOWN if fails >= threshold (or counter missing)
  // - Otherwise:
  //     if sample is FRESH and fails==0 => infer UP (prevents â€œstuck CHECKINGâ€)
  //     else keep last known UP if not stale
  //     else CHECKING
  function applyOptimistic(i){
    const cached = stateCache[i.name];

    if(i.explicitUp){ i.state="up"; return i; }
    if(i.explicitDown && !i.isStale){
      if(i.fails>=REQUIRE_CONSEC_FAILS || i.fails===0){ i.state="down"; return i; }
      i.state="checking"; return i;
    }
    if(i.isFresh && i.fails===0){ i.state="up"; return i; }

    if(cached){
      const recent = (Date.now()-(cached.lastTs||0)) <= DATA_STALE_MS;
      if(recent && cached.state==="up"){ i.state="up"; return i; }
      if(recent && cached.state==="down"){ i.state="down"; return i; }
    }
    i.state="checking"; return i;
  }

  function render(items){
    const row = items.map(chip).join("");
    laneA.innerHTML=row; laneB.innerHTML=row;
  }

  function chip(i){
    const cls=i.state;
    const label= i.state==="up"?"UP":(i.state==="down"?"DOWN":"CHECKING");
    const title=[`${i.name} â€” ${label}`,
      i.latencyMs!=null?`Latency: ${Math.round(i.latencyMs)} ms`:null,
      i.region?`Region: ${i.region}`:null,
      i.lastTs?`Updated: ${new Date(i.lastTs).toLocaleString()}`:null
    ].filter(Boolean).join(" â€¢ ");
    return `<span class="chip ${cls}" title="${escapeHtml(title)}"><span class="dot ${cls}" aria-hidden="true"></span><span class="label">${escapeHtml(i.name)}: ${label}</span></span>`;
  }

  function autosizeScroller(){
    const wrapW = root.host.getBoundingClientRect().width || 1;
    ensureWidth(laneA,wrapW); ensureWidth(laneB,wrapW);
    const laneW = laneA.scrollWidth || 600;
    const dur = Math.max(8, Math.round(laneW / PX_PER_SEC));
    rail.style.animationDuration = `${dur}s`;
  }
  function ensureWidth(lane,wrapW){
    const minW=Math.max(wrapW,600); let guard=0;
    while(lane.scrollWidth<minW && guard<8){ lane.innerHTML += lane.innerHTML; guard++; }
  }

  // utils
  function asBool(v){ if(typeof v==="boolean")return v; if(typeof v==="number")return v>0; if(typeof v==="string")return ["ok","up","true","healthy","success"].includes(v.toLowerCase()); return false; }
  function toMs(v){ if(v==null) return null; if(typeof v==="number") return v>1e12?v:v*1000; const d=new Date(v); return isNaN(d)?null:d.getTime(); }
  function numOrNull(v){ const n=Number(v); return Number.isFinite(n)?n:null; }
  function escapeHtml(s){ return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"); }
  function loadJson(k){ try{ return JSON.parse(localStorage.getItem(k)||"null"); }catch{ return null; } }
  function saveJson(k,o){ try{ localStorage.setItem(k, JSON.stringify(o)); }catch{} }
</script> <!-- Main site content --> <main id="main" class="flex-1" data-astro-cid-5hce7sga>  <section class="wrap" data-astro-cid-lp553tkn> <header data-astro-cid-lp553tkn> <h1 data-astro-cid-lp553tkn>Port Scanner (TCP)</h1> <p class="sub" data-astro-cid-lp553tkn>
A safe, guided port scanner for discovery and quick triage. Enter a host, choose ports, and weâ€™ll attempt TCP connects,
        optionally grab lightweight banners (e.g., SSH greetings, HTTP <code data-astro-cid-lp553tkn>HEAD /</code>), and probe TLS certificates on HTTPS-like ports.
<br data-astro-cid-lp553tkn> <small class="muted" data-astro-cid-lp553tkn> <strong data-astro-cid-lp553tkn>Use responsibly.</strong> Only scan systems you own or are explicitly authorized to test.
</small> </p> </header> <!-- FORM --> <div class="card" data-astro-cid-lp553tkn> <div class="grid" data-astro-cid-lp553tkn> <label data-astro-cid-lp553tkn>
Target (hostname or IPv4)
<input id="host" placeholder="e.g. example.com or 93.184.216.34" data-astro-cid-lp553tkn> <small class="hint" data-astro-cid-lp553tkn>Weâ€™ll resolve DNS if enabled below.</small> </label> <label data-astro-cid-lp553tkn>
Ports / ranges
<input id="ports" placeholder="e.g. 22,80,443 or 1-1024" data-astro-cid-lp553tkn> <small class="hint" data-astro-cid-lp553tkn>Accepts lists and ranges (comma/space separated), e.g. <code data-astro-cid-lp553tkn>22,80,1000-1010</code>.</small> </label> <label data-astro-cid-lp553tkn>
Timeout (ms)
<input id="timeout" type="number" value="1200" min="200" max="10000" data-astro-cid-lp553tkn> </label> <label data-astro-cid-lp553tkn>
Concurrency
<input id="conc" type="number" value="40" min="1" max="100" data-astro-cid-lp553tkn> </label> </div> <!-- Presets --> <div class="row presets" data-astro-cid-lp553tkn> <span data-astro-cid-lp553tkn>Presets:</span> <div class="chips" id="presetChips" data-astro-cid-lp553tkn> <button type="button" class="chip" data-ports="21,22,23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080" data-astro-cid-lp553tkn>Top 20</button><button type="button" class="chip" data-ports="80,443,8080,8443,8000,8888,8800,9443" data-astro-cid-lp553tkn>Web</button><button type="button" class="chip" data-ports="22,3389,5432,6379,27017,3306,1521,1433" data-astro-cid-lp553tkn>Infra</button><button type="button" class="chip" data-ports="25,110,143,465,587,993,995" data-astro-cid-lp553tkn>Email</button><button type="button" class="chip" data-ports="1-1024" data-astro-cid-lp553tkn>1â€“1024</button><button type="button" class="chip" data-ports data-astro-cid-lp553tkn>Custom</button> </div> </div> <!-- Toggles --> <div class="row toggles" data-astro-cid-lp553tkn> <label class="check" data-astro-cid-lp553tkn><input id="dns" type="checkbox" checked data-astro-cid-lp553tkn> Resolve DNS</label> <label class="check" data-astro-cid-lp553tkn><input id="tls" type="checkbox" checked data-astro-cid-lp553tkn> TLS probe</label> <label class="check" data-astro-cid-lp553tkn><input id="banner" type="checkbox" checked data-astro-cid-lp553tkn> Banner grab</label> </div> <!-- Advanced drawer --> <details class="adv" data-astro-cid-lp553tkn> <summary data-astro-cid-lp553tkn>What happens during a scan? (good to know)</summary> <ul class="bullets" data-astro-cid-lp553tkn> <li data-astro-cid-lp553tkn><strong data-astro-cid-lp553tkn>TCP connect:</strong> We attempt to open a TCP connection to each port within your timeout.</li> <li data-astro-cid-lp553tkn><strong data-astro-cid-lp553tkn>Banner grabbing:</strong> If enabled, we read initial greetings (SSH/SMTP/FTP) or send a safe HTTP <code data-astro-cid-lp553tkn>HEAD /</code>.</li> <li data-astro-cid-lp553tkn><strong data-astro-cid-lp553tkn>TLS probe:</strong> For HTTPS-like ports (443/8443/9443/etc.), we read certificate subject/issuer/SANs and validity dates.</li> <li data-astro-cid-lp553tkn><strong data-astro-cid-lp553tkn>Performance tips:</strong> Lower timeout and moderate concurrency for nearby targets; raise timeout for distant ones.</li> <li data-astro-cid-lp553tkn><strong data-astro-cid-lp553tkn>Limit:</strong> Max 2,000 ports per scan to keep the service responsive.</li> </ul> </details> <div class="row consent" data-astro-cid-lp553tkn> <label class="check" data-astro-cid-lp553tkn><input id="ok" type="checkbox" data-astro-cid-lp553tkn> I am authorized to scan this target.</label> </div> <!-- Actions --> <div class="row actions" data-astro-cid-lp553tkn> <button class="btn primary" id="run" data-astro-cid-lp553tkn>Run Scan</button> <button class="btn" id="clear" data-astro-cid-lp553tkn>Clear</button> <span class="spacer" data-astro-cid-lp553tkn></span> <button class="btn ghost" id="copyOpen" title="Copy list of open ports" disabled data-astro-cid-lp553tkn>Copy Open Ports</button> <button class="btn ghost" id="downloadJson" title="Download raw JSON" disabled data-astro-cid-lp553tkn>Download JSON</button> </div> <!-- Progress --> <div id="prog" class="progress" style="display:none;" data-astro-cid-lp553tkn> <div id="bar" class="bar" data-astro-cid-lp553tkn></div> <span id="pct" data-astro-cid-lp553tkn>0%</span> </div> </div> <!-- Errors --> <div id="err" class="card error" style="display:none; white-space:pre-wrap;" data-astro-cid-lp553tkn></div> <!-- Pre-info --> <div id="pre" class="card" style="display:none;" data-astro-cid-lp553tkn></div> <!-- Results --> <div id="res" class="card" style="display:none;" data-astro-cid-lp553tkn> <div class="res-head" data-astro-cid-lp553tkn> <h3 data-astro-cid-lp553tkn>Results</h3> <label class="check small" data-astro-cid-lp553tkn><input id="openOnly" type="checkbox" data-astro-cid-lp553tkn> Show open only</label> </div> <div class="table-wrap" data-astro-cid-lp553tkn> <table id="tbl" data-astro-cid-lp553tkn> <thead data-astro-cid-lp553tkn> <tr data-astro-cid-lp553tkn> <th data-sort="port" data-astro-cid-lp553tkn>Port â–²</th> <th data-astro-cid-lp553tkn>Status</th> <th data-astro-cid-lp553tkn>Service (guess)</th> <th data-astro-cid-lp553tkn>Banner / Details</th> <th data-astro-cid-lp553tkn>Latency (ms)</th> </tr> </thead> <tbody id="tbody" data-astro-cid-lp553tkn></tbody> </table> </div> </div> <!-- TLS --> <div id="tlslist" class="card" style="display:none;" data-astro-cid-lp553tkn> <h3 data-astro-cid-lp553tkn>TLS Certificates</h3> <div id="tlswrap" class="tls-grid" data-astro-cid-lp553tkn></div> </div> <!-- Recent scans --> <div class="card" data-astro-cid-lp553tkn> <h3 style="margin-bottom:.4rem;" data-astro-cid-lp553tkn>Recent scans (local)</h3> <div id="recent" class="recent" data-astro-cid-lp553tkn></div> </div> </section>  <script>
    // ---------- helpers ----------
    const $ = (id) => document.getElementById(id);
    const esc = (s)=> (s||"").toString().replace(/[&<>"']/g,(ch)=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[ch]));
    const clamp = (n,lo,hi)=> Math.max(lo, Math.min(hi, n|0));
    const MAX_PORTS = 2000;

    function parsePorts(raw){
      const parts=(raw||"").split(/[\s,]+/).filter(Boolean);
      const set=new Set();
      for(const p of parts){
        if(/^\d+$/.test(p)){ const n=+p; if(n>=1&&n<=65535) set.add(n); }
        else { const m=p.match(/^(\d+)-(\d+)$/); if(m){ let a=+m[1]|0,b=+m[2]|0; if(b<a)[a,b]=[b,a];
          a=clamp(a,1,65535); b=clamp(b,1,65535); for(let n=a;n<=b;n++) set.add(n);
        }}
      }
      return [...set].sort((x,y)=>x-y);
    }
    function toQS(obj){ const q = new URLSearchParams(); for(const [k,v] of Object.entries(obj)){ if(v!=null) q.set(k,String(v)); } return q.toString(); }
    const showErr = (m)=>{ $("err").style.display="block"; $("err").textContent=m; };
    const clearErr = ()=>{ $("err").style.display="none"; $("err").textContent=""; };

    function setProgress(done,total){
      const pct = total ? Math.round(done/total*100) : 0;
      $("prog").style.display = total ? "block" : "none";
      $("bar").style.width = pct + "%";
      $("pct").textContent = pct + "%";
    }

    function saveRecent(entry){
      try{
        const key="portscan_recent";
        const arr = JSON.parse(localStorage.getItem(key) || "[]");
        // de-dupe by host+ports
        const tag = entry.host + "|" + entry.ports;
        const filtered = arr.filter(x => (x.host + "|" + x.ports) !== tag);
        filtered.unshift({...entry, t: Date.now()});
        localStorage.setItem(key, JSON.stringify(filtered.slice(0,10)));
        renderRecent();
      }catch{}
    }
    function renderRecent(){
      const cont = $("recent"); if(!cont) return;
      cont.innerHTML = "";
      try{
        const arr = JSON.parse(localStorage.getItem("portscan_recent") || "[]");
        for(const x of arr){
          const b = document.createElement("button");
          b.className="pill";
          b.innerHTML = `<b>${esc(x.host)}</b> <small>${esc(x.ports)}</small>`;
          b.onclick = ()=> {
            $("host").value = x.host;
            $("ports").value = x.ports;
            $("timeout").value = x.timeout;
            $("conc").value = x.concurrency;
            $("dns").checked = !!x.dnsFirst;
            $("tls").checked = !!x.tlsProbe;
            $("banner").checked = !!x.bannerGrab;
          };
          cont.appendChild(b);
        }
      }catch{}
    }

    // ---------- UI behavior ----------
    // preset chips
    document.addEventListener("click", (e)=>{
      const t = e.target;
      if(t && t.classList && t.classList.contains("chip")){
        const val = t.getAttribute("data-ports") || "";
        if(val) $("ports").value = val;
        else $("ports").focus();
      }
    });

    // sort by port toggle
    let sortAsc = true;
    document.querySelector('th[data-sort="port"]').addEventListener("click", ()=>{
      sortAsc = !sortAsc;
      const head = document.querySelector('th[data-sort="port"]');
      head.textContent = sortAsc ? "Port â–²" : "Port â–¼";
      // re-render from lastData
      if(window._lastData) renderTable(window._lastData);
    });

    $("openOnly").addEventListener("change", ()=>{
      if(window._lastData) renderTable(window._lastData);
    });

    $("clear").onclick = ()=>{
      clearErr();
      $("pre").style.display="none";
      $("res").style.display="none";
      $("tlslist").style.display="none";
      $("tbody").innerHTML="";
      $("tlswrap").innerHTML="";
      setProgress(0,0);
      $("copyOpen").disabled = true;
      $("downloadJson").disabled = true;
    };

    $("copyOpen").onclick = ()=>{
      const rows = window._lastData?.results || [];
      const opens = rows.filter(r=>r.status==="open").map(r=>r.port).join(",");
      navigator.clipboard.writeText(opens || "").then(()=>{},()=>{});
    };

    $("downloadJson").onclick = ()=>{
      const blob = new Blob([JSON.stringify(window._lastData || {}, null, 2)], {type:"application/json"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = `portscan_${Date.now()}.json`;
      a.click();
      URL.revokeObjectURL(a.href);
    };

    // ---------- RUN ----------
    $("run").onclick = async ()=>{
      clearErr();
      if(!$("ok").checked) return showErr("Please confirm you are authorized to scan this target.");
      const host = $("host").value.trim().toLowerCase();
      if(!host) return showErr("Enter a target host (hostname or IPv4).");

      // normalize/validate ports
      const parsed = parsePorts($("ports").value.trim());
      if(!parsed.length) return showErr("Enter at least one port or range (e.g., 22,80,443 or 1-1024).");
      if(parsed.length > MAX_PORTS) return showErr("Max 2,000 ports per scan â€” narrow your selection.");

      const timeout = clamp(+$("timeout").value || 1200, 200, 10000);
      const concurrency = clamp(+$("conc").value || 40, 1, 100);

      const params = {
        host,
        ports: parsed.join(","),
        timeout,
        concurrency,
        dnsFirst: $("dns").checked ? 1 : 0,
        tlsProbe: $("tls").checked ? 1 : 0,
        bannerGrab: $("banner").checked ? 1 : 0
      };

      // Save to recents
      saveRecent({ ...params });

      // absolute URL to sibling endpoint
      const url = new URL("/free-tools/scan", window.location.origin);
      url.search = toQS(params);

      // UI prep
      $("tbody").innerHTML = "";
      $("tlswrap").innerHTML = "";
      $("pre").style.display="none";
      $("res").style.display="none";
      $("tlslist").style.display="none";
      setProgress(0, parsed.length);

      try{
        const r = await fetch(url.toString(), { method:"GET", headers:{ "Accept":"application/json" } });
        const txt = await r.text();

        if(!r.ok){
          try {
            const j = JSON.parse(txt);
            return showErr(`API error ${r.status}\n${j.error || ""}${j.details ? `\n${JSON.stringify(j.details, null, 2)}` : ""}`);
          } catch {
            return showErr(`API error ${r.status} ${r.statusText}\n${txt}`);
          }
        }

        const data = JSON.parse(txt);
        window._lastData = data;
        renderPre(data);
        renderTable(data);
        renderTLS(data);
        $("copyOpen").disabled = !Array.isArray(data?.results) || !data.results.length;
        $("downloadJson").disabled = !data;
        setProgress(parsed.length, parsed.length);
      }catch(e){
        showErr("Network/JS error: " + (e?.message || e));
      }
    };

    function renderPre(data){
      if(!data?.pre) return;
      $("pre").style.display="block";
      $("pre").innerHTML = `
        <h3>Target</h3>
        <div><strong>Host:</strong> ${esc(data.pre.host||"")}</div>
        ${data.pre.ip? `<div><strong>Resolved IP:</strong> ${esc(data.pre.ip)}</div>` : ""}
        ${data.pre.ptr? `<div><strong>Reverse DNS:</strong> ${esc(data.pre.ptr)}</div>` : ""}
      `;
    }

    function renderTable(data){
      const body = $("tbody");
      body.innerHTML="";
      const rows = (data?.results || []).slice().sort((a,b)=> sortAsc ? a.port-b.port : b.port-a.port);
      const showOpenOnly = $("openOnly").checked;
      const filtered = showOpenOnly ? rows.filter(r=>r.status==="open") : rows;
      filtered.forEach(r=>{
        const tr = document.createElement("tr");
        const cls = r.status==="open" ? "open" : r.status==="closed" ? "closed" : "timeout";
        const banner = (r.banner || r.http || r.ssh || r.smtp || "");
        tr.innerHTML = `
          <td>${r.port}</td>
          <td class="${cls}">${esc(String(r.status||"").toUpperCase())}</td>
          <td>${esc(r.service||"")}</td>
          <td><pre style="white-space:pre-wrap;margin:0;">${esc(String(banner).slice(0,240))}</pre></td>
          <td>${typeof r.rtt==="number" ? Math.round(r.rtt) : ""}</td>
        `;
        body.appendChild(tr);
      });
      $("res").style.display = "block";
    }

    function renderTLS(data){
      const arr = data?.tls || [];
      if(!arr.length) return;
      $("tlslist").style.display="block";
      const wrap = $("tlswrap");
      wrap.innerHTML = "";
      for(const cert of arr){
        const div = document.createElement("div");
        div.className = "tls-card";
        div.innerHTML = `
          <div><strong>Port:</strong> ${cert.port}</div>
          <div><strong>Subject CN:</strong> ${esc(cert.subjectCN||"")}</div>
          <div><strong>Issuer:</strong> ${esc(cert.issuer||"")}</div>
          <div><strong>Valid:</strong> ${esc(cert.valid_from||"")} â†’ ${esc(cert.valid_to||"")}</div>
          ${Array.isArray(cert.san) && cert.san.length ? `<div><strong>SANs:</strong> <code>${cert.san.map(esc).join(", ")}</code></div>` : ""}
          ${cert.protocol ? `<div><strong>Protocol:</strong> ${esc(cert.protocol)}</div>` : ""}
          ${cert.alpn ? `<div><strong>ALPN:</strong> ${esc(cert.alpn)}</div>` : ""}
        `;
        wrap.appendChild(div);
      }
    }

    // initial
    renderRecent();
  </script>  </main> <footer class="mt-auto flex w-full flex-col items-center justify-center gap-y-2 pt-10 pb-4 text-center align-top font-semibold text-gray-600 sm:flex-row sm:justify-between sm:text-xs dark:text-gray-400"> <div class="me-0 sm:me-4">
&copy; J The Admin 2025.<span class="inline-block">&nbsp;ðŸš€&nbsp;Ping.Trace.SSH</span> </div> <!-- Hidden on mobile, shown from md and up --> <nav aria-labelledby="footer_links" class="hidden md:flex gap-x-2 md:gap-x-0 md:divide-x md:divide-gray-500"> <p id="footer_links" class="sr-only">More on this site</p> <a class="hover:text-global-text px-4 py-2 hover:underline md:py-0" href="/"> Home </a><a class="hover:text-global-text px-4 py-2 hover:underline md:py-0" href="/services/"> Services </a><a class="hover:text-global-text px-4 py-2 hover:underline md:py-0" href="/career/"> Career Tools </a><a class="hover:text-global-text px-4 py-2 hover:underline md:py-0" href="/free-tools/"> Networking Tools </a><a class="hover:text-global-text px-4 py-2 hover:underline md:py-0" href="/breakroom/"> Breakroom </a><a class="hover:text-global-text px-4 py-2 hover:underline md:py-0" href="/about/"> About </a> </nav> </footer> <!-- Hide footer navigation links on mobile only -->  </body> </html>